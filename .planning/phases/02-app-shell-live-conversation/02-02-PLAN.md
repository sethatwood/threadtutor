---
phase: 02-app-shell-live-conversation
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - components/message.tsx
  - components/skeleton-message.tsx
  - components/confidence-check.tsx
  - components/concept-map-placeholder.tsx
  - components/journal-placeholder.tsx
autonomous: true

must_haves:
  truths:
    - "Assistant messages render markdown with proper typographic styling (headings, lists, bold, links visible)"
    - "User messages render as plain text without markdown interpretation"
    - "Confidence check cards display the question in a visually distinct colored card"
    - "When a confidence check has an assessment, the assessment label and feedback are shown"
    - "When a confidence check is pending, an embedded input area appears inside the card"
    - "A shimmer skeleton placeholder appears where Claude's response will load"
  artifacts:
    - path: "components/message.tsx"
      provides: "Single turn renderer with react-markdown for assistant messages"
      exports: ["Message"]
    - path: "components/skeleton-message.tsx"
      provides: "Loading placeholder with shimmer animation"
      exports: ["SkeletonMessage"]
    - path: "components/confidence-check.tsx"
      provides: "Confidence check card with embedded input and assessment display"
      exports: ["ConfidenceCheckCard"]
    - path: "components/concept-map-placeholder.tsx"
      provides: "Static placeholder for left panel"
      exports: ["ConceptMapPlaceholder"]
    - path: "components/journal-placeholder.tsx"
      provides: "Static placeholder for right panel"
      exports: ["JournalPlaceholder"]
  key_links:
    - from: "components/message.tsx"
      to: "react-markdown"
      via: "Markdown component import"
      pattern: "import.*from.*react-markdown"
    - from: "components/message.tsx"
      to: "components/confidence-check.tsx"
      via: "renders ConfidenceCheckCard when turn has confidenceCheck"
      pattern: "ConfidenceCheckCard"
    - from: "components/confidence-check.tsx"
      to: "lib/types.ts"
      via: "ConfidenceCheck type for props"
      pattern: "import.*ConfidenceCheck.*from.*types"
---

<objective>
Create all leaf UI components for Phase 2: the message renderer (with react-markdown for assistant turns), confidence check card (with embedded input and assessment display), skeleton loading placeholder, and panel placeholders for concept map and learning journal.

Purpose: These are the visual building blocks that the conversation panel (Plan 03) will compose. Each component is self-contained with clear props interfaces. Building them separately ensures each can be styled and verified independently before assembly.

Output: Five component files in the components/ directory, all marked "use client".
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-app-shell-live-conversation/02-CONTEXT.md
@.planning/phases/02-app-shell-live-conversation/02-RESEARCH.md
@lib/types.ts
@app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create message renderer and skeleton loading component</name>
  <files>components/message.tsx, components/skeleton-message.tsx</files>
  <action>
    **components/message.tsx:** Create a `"use client"` component that renders a single conversation turn.

    Props: `{ turn: Turn; children?: React.ReactNode }` where `children` is used to render a confidence check card inline after the message content (the parent conversation-panel will pass ConfidenceCheckCard as children when appropriate).

    For assistant turns:
    - Wrap content in `<div className="prose prose-zinc prose-sm max-w-none">` for typography styling
    - Render `turn.displayText` through the `<Markdown>` component from react-markdown
    - After the markdown content, render `{children}` (for inline confidence check card)

    For user turns:
    - Render `turn.displayText` as plain text in a `<p>` tag (do NOT use react-markdown for user messages)
    - Style with muted text color to visually distinguish from assistant messages

    Overall message wrapper: full-width, no bubbles, with vertical padding (py-5 or py-6) and a subtle bottom border (border-b border-zinc-100) for visual separation between messages. Flat layout like Claude.ai/ChatGPT, not chat bubbles.

    Add a small role label above the message: "Claude" for assistant turns (in a muted small font, maybe with a subtle accent color), and "You" for user turns.

    **components/skeleton-message.tsx:** Create a `"use client"` shimmer skeleton loading component.

    Use the shimmer animation defined in globals.css (animate-shimmer). Create 3-4 horizontal bars of varying widths (w-3/4, w-full, w-5/6, w-2/3) with the shimmer gradient: `bg-gradient-to-r from-zinc-200 via-zinc-100 to-zinc-200 bg-[length:200%_100%] animate-shimmer`. Each bar should be a rounded div with h-4 height.

    Wrap in the same vertical padding as a regular message for consistent spacing.

    Design notes (from CONTEXT.md):
    - Clean and minimal visual tone (Notion-like): lots of whitespace, muted colors
    - Flat, full-width messages with subtle dividers or spacing (not chat bubbles)
  </action>
  <verify>
    Run `npm run build` to confirm both components compile without TypeScript errors.
    Verify message.tsx imports from react-markdown and @/lib/types.
    Verify skeleton-message.tsx uses animate-shimmer class.
  </verify>
  <done>Message component renders assistant turns with markdown typography and user turns as plain text. Skeleton component displays a shimmer animation matching the message layout dimensions.</done>
</task>

<task type="auto">
  <name>Task 2: Create confidence check card and panel placeholders</name>
  <files>components/confidence-check.tsx, components/concept-map-placeholder.tsx, components/journal-placeholder.tsx</files>
  <action>
    **components/confidence-check.tsx:** Create a `"use client"` component for confidence check cards.

    Props interface:
    ```
    {
      check: ConfidenceCheck;
      onSubmit?: (answer: string) => void;
      isPending: boolean;  // true when waiting for user's answer
    }
    ```

    The card renders inside the message flow (passed as children to Message component). Style it as a distinct card with:
    - Left border accent (border-l-4) with a muted indigo or blue-gray color
    - Subtle background tint (bg-indigo-50/50 or similar muted color)
    - Rounded corners (rounded-lg)
    - Padding (p-4), margin-top (mt-3)

    Content sections:
    1. **Question:** Always visible. Display `check.question` in medium-weight text.

    2. **Assessment result** (shown when `check.assessment` exists):
       - Display assessment as a small pill/badge with muted accent colors:
         - "tracking": text-emerald-700 bg-emerald-50 (not bright green)
         - "partial": text-amber-700 bg-amber-50 (not bright yellow)
         - "confused": text-rose-700 bg-rose-50 (not bright red)
       - Display `check.feedback` below the badge in muted text

    3. **Input area** (shown when `isPending` is true AND `check.assessment` does not exist AND `onSubmit` is provided):
       - An auto-growing textarea with the same enter-to-send, shift+enter-for-newline behavior
       - Use local useState for the input value
       - A small send button next to/below the textarea
       - Placeholder text like "Type your answer..."
       - On submit: call `onSubmit(answer)`, clear the local input state
       - The textarea should use the scrollHeight auto-resize pattern (same as described in research)

    Design notes (from CONTEXT.md):
    - Assessment results shown as text labels with subtle muted accent colors, not bold traffic-light colors
    - Confidence check input lives inside the check card, not in the main input area

    **components/concept-map-placeholder.tsx:** Simple `"use client"` component. Renders a centered "Concept Map" label in muted text (text-zinc-400, text-sm). This is a placeholder until Phase 3. The component should fill its container height with flexbox centering.

    **components/journal-placeholder.tsx:** Simple `"use client"` component. Renders a centered "Learning Journal" label in muted text. Same styling approach as the concept map placeholder. Placeholder until Phase 4.
  </action>
  <verify>
    Run `npm run build` to confirm all three components compile.
    Verify confidence-check.tsx imports ConfidenceCheck from @/lib/types.
    Verify confidence-check.tsx handles all three states: pending with input, assessed with badge, and question-only.
  </verify>
  <done>Confidence check card renders the question with optional embedded input (when pending) or assessment badge with feedback (when assessed). Panel placeholders display centered labels ready for Phase 3 and Phase 4 implementation.</done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds with no errors
2. components/message.tsx renders assistant turns through react-markdown with prose class
3. components/message.tsx renders user turns as plain text
4. components/skeleton-message.tsx uses shimmer animation
5. components/confidence-check.tsx shows input when isPending, assessment when assessed
6. components/concept-map-placeholder.tsx and journal-placeholder.tsx render placeholder labels
</verification>

<success_criteria>
All five leaf UI components compile, are properly typed, and follow the Notion-like design guidelines from the phase context. Each component has a clear props interface ready for composition in Plan 03.
</success_criteria>

<output>
After completion, create `.planning/phases/02-app-shell-live-conversation/02-02-SUMMARY.md`
</output>
