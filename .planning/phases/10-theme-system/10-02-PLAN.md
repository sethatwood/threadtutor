---
phase: 10-theme-system
plan: 02
type: execute
wave: 2
depends_on: ["10-01"]
files_modified:
  - components/topic-picker.tsx
  - components/conversation-panel.tsx
  - components/session-list.tsx
  - components/message.tsx
  - components/confidence-check.tsx
  - components/skeleton-message.tsx
  - components/app-header.tsx
  - components/concept-node.tsx
  - components/learning-journal.tsx
  - components/conversation-shell.tsx
  - components/replay-shell.tsx
  - components/replay-controls.tsx
  - components/replay-conversation.tsx
autonomous: true

must_haves:
  truths:
    - "Dark theme background is near-black (#0a0a0a), light theme background is warm off-white (#f8f6f3)"
    - "All text, borders, inputs, and backgrounds adapt when theme toggles -- no hardcoded zinc colors remain visible"
    - "Indigo and emerald accent colors are preserved and appropriate for both theme backgrounds"
    - "Switching themes while in a conversation shows all UI elements styled correctly"
  artifacts:
    - path: "components/topic-picker.tsx"
      provides: "Theme-aware landing page with inputs, buttons, and topic chips"
    - path: "components/conversation-panel.tsx"
      provides: "Theme-aware input area and error banner"
    - path: "components/message.tsx"
      provides: "Theme-aware message rendering with prose styles"
    - path: "components/confidence-check.tsx"
      provides: "Theme-aware confidence check card with assessment badges"
    - path: "components/app-header.tsx"
      provides: "Theme-aware header with borders, text, and badges"
    - path: "components/concept-node.tsx"
      provides: "Theme-aware concept node tooltip"
    - path: "components/learning-journal.tsx"
      provides: "Theme-aware journal entries and header"
    - path: "components/conversation-shell.tsx"
      provides: "Theme-aware panel borders and layout chrome"
    - path: "components/replay-shell.tsx"
      provides: "Theme-aware replay layout borders"
    - path: "components/replay-controls.tsx"
      provides: "Theme-aware replay toolbar"
  key_links:
    - from: "all components"
      to: "globals.css"
      via: "CSS custom properties (var(--color-*))"
      pattern: "var\\(--color-"
---

<objective>
Migrate all component hardcoded Tailwind color classes (zinc-800, zinc-700, zinc-100, etc.) to CSS custom property references (var(--color-*)), so every UI element responds to the theme toggle established in Plan 01.

Purpose: After this plan, the entire app renders correctly in both dark and light themes. No hardcoded dark-mode-only colors remain.

Output: All 13 component files updated to use CSS variable references instead of hardcoded zinc/color classes.
</objective>

<execution_context>
@/Users/yayseth/.claude/get-shit-done/workflows/execute-plan.md
@/Users/yayseth/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Plan 01 SUMMARY for CSS variable names
@.planning/phases/10-theme-system/10-01-SUMMARY.md

# Components to migrate
@components/topic-picker.tsx
@components/conversation-panel.tsx
@components/session-list.tsx
@components/message.tsx
@components/confidence-check.tsx
@components/skeleton-message.tsx
@components/app-header.tsx
@components/concept-node.tsx
@components/learning-journal.tsx
@components/conversation-shell.tsx
@components/replay-shell.tsx
@components/replay-controls.tsx
@components/replay-conversation.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate core interaction components to theme variables</name>
  <files>
    components/topic-picker.tsx
    components/conversation-panel.tsx
    components/session-list.tsx
    components/message.tsx
    components/confidence-check.tsx
    components/skeleton-message.tsx
  </files>
  <action>
Replace all hardcoded Tailwind color utility classes with inline CSS variable references using Tailwind's arbitrary value syntax. The mapping from old classes to new values:

**Color mapping reference:**
| Old Tailwind Class | New Value |
|---|---|
| `bg-zinc-800` or `bg-zinc-800/50` or `bg-zinc-800/60` | `bg-[var(--color-surface)]` (add opacity variant as needed with `/50` etc.) |
| `bg-zinc-900/90` | `bg-[var(--color-bg)]/90` |
| `border-zinc-800` | `border-[var(--color-border)]` |
| `border-zinc-700` or `border-zinc-700/50` | `border-[var(--color-border)]` |
| `text-zinc-100` | `text-[var(--color-text)]` |
| `text-zinc-200` | `text-[var(--color-text)]` |
| `text-zinc-300` | `text-[var(--color-text)]` (or `text-[var(--color-text-muted)]` for secondary) |
| `text-zinc-400` | `text-[var(--color-text-muted)]` |
| `text-zinc-500` | `text-[var(--color-text-dim)]` |
| `text-zinc-600` | `text-[var(--color-text-dim)]` |
| `placeholder:text-zinc-500` | `placeholder:text-[var(--color-text-dim)]` |
| `text-indigo-400` | `text-[var(--color-accent-indigo)]` |
| `text-indigo-300` | `text-[var(--color-accent-indigo-hover)]` |
| `hover:bg-zinc-800` | `hover:bg-[var(--color-surface)]` |
| `hover:bg-zinc-700` or `hover:bg-zinc-700/60` | `hover:bg-[var(--color-border)]` |
| `hover:text-zinc-200` or `hover:text-zinc-100` | `hover:text-[var(--color-text)]` |
| `hover:border-indigo-500/50` | `hover:border-[var(--color-accent-indigo)]` (with opacity) |
| `hover:bg-indigo-500/10` | `hover:bg-[var(--color-accent-indigo)]/10` |
| `hover:text-indigo-300` | `hover:text-[var(--color-accent-indigo-hover)]` |
| `bg-indigo-600` | `bg-[var(--color-primary-bg)]` |
| `hover:bg-indigo-500` | `hover:bg-[var(--color-primary-bg-hover)]` |
| `focus:ring-indigo-500/40` | `focus:ring-[var(--color-accent-indigo)]/40` |
| `focus:border-indigo-500/60` | `focus:border-[var(--color-accent-indigo)]/60` |

**Do NOT change:**
- Semantic colors that stay the same in both themes: `text-white` on primary buttons (white text on indigo bg works in both themes), `bg-rose-500/10`, `text-rose-300`, `text-emerald-300`, `text-amber-300` (assessment badge colors are intentionally vivid)
- `prose-invert` class on messages -- this needs special handling. In dark mode we want `prose-invert` (light text on dark bg), in light mode we want default prose (dark text on light bg). Use a conditional class or replace with explicit prose color overrides using CSS variables.

**Specific component notes:**

**message.tsx**: The prose class needs attention. Replace `prose-invert` and the hardcoded prose modifier classes with CSS-variable-based overrides. Remove `prose-invert` and instead use: `prose prose-sm md:prose-base max-w-none` with these overrides:
- `prose-p:text-[var(--color-text)]`
- `prose-p:leading-[1.7]`
- `prose-headings:text-[var(--color-text)]`
- `prose-strong:text-[var(--color-text)]`
- `prose-code:text-[var(--color-accent-indigo)]`
- `prose-code:bg-[var(--color-surface)]`
- `prose-pre:bg-[var(--color-surface)]`
This way the prose automatically adapts to either theme without needing `prose-invert`.

**confidence-check.tsx**: The assessment badge colors (emerald/amber/rose) can stay as-is because they are semantic indicators. But the card background (`bg-indigo-500/10`), border-l (`border-indigo-500/50`), question text, feedback text, and input fields need migration. The card border-l and background should use `border-l-[var(--color-accent-indigo)]/50` and `bg-[var(--color-accent-indigo)]/10`.

**skeleton-message.tsx**: Update the shimmer gradient to use CSS vars: `from-[var(--color-surface)] via-[var(--color-border)] to-[var(--color-surface)]`. The "Claude" label should use `text-[var(--color-accent-indigo)]`.

**topic-picker.tsx**: This is the largest file. Migrate all input fields, buttons, topic chips, API key section, and loading state. The hero logo SVG colors (#6366f1, #a5b4fc, #818cf8, #34d399) can stay hardcoded since they are brand colors that look acceptable on both backgrounds. The hero title and subtitle text need migration.

**session-list.tsx**: Migrate the section heading, container border/bg, session item text, date text, and action button colors.

**conversation-panel.tsx**: Migrate textarea, send button, error banner border/bg, and the input area border-t.
  </action>
  <verify>
Run `npm run build` to confirm no build errors. Grep all six files for remaining `zinc-` class references to confirm none remain (except where intentionally preserved). Verify no `text-zinc-` or `bg-zinc-` or `border-zinc-` classes exist.
  </verify>
  <done>
All six core interaction components use CSS custom properties instead of hardcoded Tailwind zinc colors. Text, backgrounds, borders, inputs, buttons, and prose markdown rendering all adapt to the active theme. Assessment badge semantic colors (emerald/amber/rose) are preserved. The app renders correctly in both dark and light modes for conversation flow, topic selection, and session management.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate shell, chrome, and replay components to theme variables</name>
  <files>
    components/app-header.tsx
    components/concept-node.tsx
    components/learning-journal.tsx
    components/conversation-shell.tsx
    components/replay-shell.tsx
    components/replay-controls.tsx
    components/replay-conversation.tsx
  </files>
  <action>
Apply the same color mapping from Task 1 to the remaining seven components. These are the structural layout (shells), navigation (header), visualization (concept map node), and replay components.

**app-header.tsx**: Migrate the header border-b, title text, tagline text, separator, topic breadcrumb, and mode badge borders/text. The toggle button was already added in Plan 01 using inline vars, so that should be fine. Specific mappings:
- `border-zinc-800` -> `border-[var(--color-border)]`
- `text-zinc-100` -> `text-[var(--color-text)]` (title)
- `text-zinc-500` -> `text-[var(--color-text-dim)]` (tagline)
- `text-zinc-600` -> `text-[var(--color-text-dim)]` (separator)
- `text-zinc-400` -> `text-[var(--color-text-muted)]` (topic breadcrumb)
- Mode badge `text-indigo-400` -> `text-[var(--color-accent-indigo)]`, `border-indigo-500/30` -> `border-[var(--color-accent-indigo)]/30`
- Mode badge `text-emerald-400` -> `text-[var(--color-accent-emerald)]`, `border-emerald-500/30` -> `border-[var(--color-accent-emerald)]/30`

**concept-node.tsx**: Migrate the tooltip/NodeToolbar popup:
- `bg-zinc-800` -> `bg-[var(--color-bg-elevated)]`
- `border-zinc-700` -> `border-[var(--color-border)]`
- `text-zinc-300` -> `text-[var(--color-text-muted)]`
- Concept label `text-zinc-200` -> `text-[var(--color-text)]`

**learning-journal.tsx**: Migrate:
- Empty state `text-zinc-600` -> `text-[var(--color-text-dim)]`
- Header border `border-zinc-800` -> `border-[var(--color-border)]`
- Header text `text-zinc-300` -> `text-[var(--color-text-muted)]`
- Entry text `text-zinc-400` -> `text-[var(--color-text-muted)]`
- Entry number `text-indigo-400/60` -> `text-[var(--color-accent-indigo)]/60`

**conversation-shell.tsx**: Migrate:
- Panel borders `border-zinc-800` -> `border-[var(--color-border)]`
- Export/New topic buttons: `text-zinc-400` -> `text-[var(--color-text-muted)]`, `hover:bg-zinc-800` -> `hover:bg-[var(--color-surface)]`, `hover:text-zinc-200` -> `hover:text-[var(--color-text)]`
- Mobile journal summary: `text-zinc-300` -> `text-[var(--color-text)]`, chevron `text-zinc-500` -> `text-[var(--color-text-dim)]`

**replay-shell.tsx**: Same panel border migration as conversation-shell. Also:
- "Try it live" button: `bg-indigo-600` -> `bg-[var(--color-primary-bg)]`, `hover:bg-indigo-500` -> `hover:bg-[var(--color-primary-bg-hover)]`
- "Exit" button: same as Export/New topic in conversation-shell
- Mobile journal summary: same as conversation-shell

**replay-controls.tsx**: Migrate the floating toolbar:
- Container: `border-zinc-700` -> `border-[var(--color-border)]`, `bg-zinc-900/90` -> `bg-[var(--color-bg)]/90`
- Button text: `text-zinc-300` -> `text-[var(--color-text-muted)]`, `hover:bg-zinc-700/60` -> `hover:bg-[var(--color-border)]/60`, `hover:text-zinc-100` -> `hover:text-[var(--color-text)]`
- Auto-play active: `text-indigo-400` -> `text-[var(--color-accent-indigo)]`
- Progress text: `text-zinc-500` -> `text-[var(--color-text-dim)]`

**replay-conversation.tsx**: Read this file first. Apply the same mappings used in message.tsx for any message rendering. It likely reuses the Message component, so changes may be minimal.
  </action>
  <verify>
Run `npm run build` to confirm no build errors. Grep all modified files plus all components/ for any remaining `zinc-` class references. The ONLY acceptable remaining zinc references would be in files NOT part of the app's UI (e.g., node_modules). All `text-zinc-*`, `bg-zinc-*`, `border-zinc-*`, `hover:bg-zinc-*`, `hover:text-zinc-*`, `divide-zinc-*` classes should be replaced across all component files.
  </verify>
  <done>
All shell, chrome, and replay components use CSS custom properties instead of hardcoded Tailwind zinc colors. The entire app UI adapts to theme changes. Header, concept map nodes/tooltips, learning journal, replay controls, and panel borders all respond to the data-theme toggle. Zero hardcoded zinc color classes remain in any component file.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` passes with zero errors
2. `grep -r "zinc-" components/` returns zero matches (no hardcoded zinc colors remain)
3. Toggle between dark and light themes -- ALL UI elements (header, messages, inputs, concept map, journal, topic picker, replay controls) adapt colors appropriately
4. Dark theme has #0a0a0a background, light theme has #f8f6f3 background
5. Indigo accent (badges, labels, buttons) and emerald accent (live badge) are visible and appropriate in both themes
6. Assessment badges (emerald/amber/rose) remain vivid and readable in both themes
7. Prose markdown in assistant messages is readable in both themes
</verification>

<success_criteria>
- Zero `zinc-` hardcoded color classes remain in any component file
- The app renders correctly and readably in both dark and light themes
- Toggling themes mid-conversation shows all elements properly themed
- Dark theme: near-black bg, light text, indigo/emerald accents
- Light theme: warm off-white bg, dark text, adjusted indigo/emerald accents for contrast
- `npm run build` passes
</success_criteria>

<output>
After completion, create `.planning/phases/10-theme-system/10-02-SUMMARY.md`
</output>
