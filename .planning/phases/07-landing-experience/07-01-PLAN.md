---
phase: 07-landing-experience
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/app-header.tsx
  - components/conversation-shell.tsx
  - components/replay-shell.tsx
autonomous: true

must_haves:
  truths:
    - "Header displays 'ThreadTutor' branding with 'Socratic learning with AI' tagline in both live and replay modes"
    - "Header displays the current topic name in both modes"
    - "A mode badge shows 'Live' (emerald) when in live mode and 'Replay' (indigo) when in replay mode"
    - "ReplayShell header contains a prominent 'Try it live' CTA button styled with filled indigo-600"
    - "Clicking 'Try it live' exits replay and shows the TopicPicker form (same as onBack)"
    - "Header height is consistent between live and replay modes (both show tagline)"
  artifacts:
    - path: "components/app-header.tsx"
      provides: "Shared header component with branding, tagline, topic, mode badge, and children action slot"
      exports: ["AppHeader"]
    - path: "components/conversation-shell.tsx"
      provides: "Live conversation shell using AppHeader with 'Live' badge"
      contains: "AppHeader"
    - path: "components/replay-shell.tsx"
      provides: "Replay shell using AppHeader with 'Replay' badge and 'Try it live' CTA"
      contains: "AppHeader"
  key_links:
    - from: "components/conversation-shell.tsx"
      to: "components/app-header.tsx"
      via: "import and render AppHeader with mode='live'"
      pattern: "AppHeader.*mode.*live"
    - from: "components/replay-shell.tsx"
      to: "components/app-header.tsx"
      via: "import and render AppHeader with mode='replay'"
      pattern: "AppHeader.*mode.*replay"
    - from: "components/replay-shell.tsx"
      to: "components/topic-picker.tsx"
      via: "onBack callback triggered by 'Try it live' button (same exit path)"
      pattern: "onBack"
---

<objective>
Extract a shared AppHeader component and integrate it into both ConversationShell and ReplayShell, adding branding with tagline, mode indicators, and a "Try it live" CTA for replay visitors.

Purpose: Satisfy LAND-01 (clear path from replay to live), LAND-04 (mode indicator), and LAND-05 (header branding, tagline, topic name). This completes the landing experience phase.
Output: Unified header across both shells with consistent branding, mode badges, and conversion CTA.
</objective>

<execution_context>
@/Users/yayseth/.claude/get-shit-done/workflows/execute-plan.md
@/Users/yayseth/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-landing-experience/07-RESEARCH.md
@components/conversation-shell.tsx
@components/replay-shell.tsx
@components/topic-picker.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shared AppHeader component</name>
  <files>components/app-header.tsx</files>
  <action>
Create `components/app-header.tsx` with a shared header component used by both shells.

Props interface:
- `topic: string` -- current topic name
- `mode: "live" | "replay"` -- determines badge color and label
- `children?: React.ReactNode` -- right-side action slot for shell-specific buttons

Layout (matching existing header pattern from both shells):
- Outer: `<header className="flex items-center justify-between border-b border-zinc-800 px-6 py-3">`
- Left side: branding block + separator + topic name
  - Branding block: flex-col with "ThreadTutor" (text-base font-semibold text-zinc-100) and tagline "Socratic learning with AI" (text-xs text-zinc-500) on a second line
  - Separator: `<span className="text-zinc-600">/</span>`
  - Topic: `<span className="text-sm text-zinc-400">{topic}</span>`
- Right side: flex items-center gap-2 containing:
  - Mode badge: `<span>` with rounded-full px-2.5 py-0.5 text-xs border styling
    - Replay: text-indigo-400 border-indigo-500/30, label "Replay"
    - Live: text-emerald-400 border-emerald-500/30, label "Live"
  - `{children}` -- action slot for Export, New topic, Try it live, Exit, etc.

The branding block uses flex-col (not items-center) so the tagline sits below "ThreadTutor". The gap-3 between branding block and separator keeps the layout clean.

No "use client" directive needed -- this is a pure presentational component with no hooks or browser APIs.
  </action>
  <verify>`npx tsc --noEmit` passes with no errors on the new file.</verify>
  <done>AppHeader component exists at components/app-header.tsx, exports AppHeader, accepts topic/mode/children props, renders branding with tagline, mode badge with correct colors, and children action slot.</done>
</task>

<task type="auto">
  <name>Task 2: Integrate AppHeader into ConversationShell and ReplayShell</name>
  <files>components/conversation-shell.tsx, components/replay-shell.tsx</files>
  <action>
**ConversationShell (components/conversation-shell.tsx):**
1. Import `AppHeader` from `@/components/app-header`
2. Replace the entire inline `<header>...</header>` block (lines 103-132) with:
   ```
   <AppHeader topic={topic} mode="live">
     {state.turns.length > 0 && (
       <button type="button" onClick={handleExport} className="rounded-md px-3 py-1.5 text-sm text-zinc-400 hover:bg-zinc-800 hover:text-zinc-200 transition-colors">
         Export
       </button>
     )}
     {onBack && (
       <button type="button" onClick={onBack} className="rounded-md px-3 py-1.5 text-sm text-zinc-400 hover:bg-zinc-800 hover:text-zinc-200 transition-colors">
         New topic
       </button>
     )}
   </AppHeader>
   ```
3. The rest of ConversationShell remains unchanged (three-panel body, hooks, effects).

**ReplayShell (components/replay-shell.tsx):**
1. Import `AppHeader` from `@/components/app-header`
2. Replace the entire inline `<header>...</header>` block (lines 35-58) with:
   ```
   <AppHeader topic={session.topic} mode="replay">
     <button type="button" onClick={onBack} className="rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-indigo-500 transition-colors">
       Try it live
     </button>
     <button type="button" onClick={onBack} className="rounded-md px-3 py-1.5 text-sm text-zinc-400 hover:bg-zinc-800 hover:text-zinc-200 transition-colors">
       Exit
     </button>
   </AppHeader>
   ```
3. Both "Try it live" and "Exit" call `onBack` (research confirmed the flow is identical -- both return to TopicPicker). The difference is visual prominence: "Try it live" uses the filled indigo-600 CTA style (rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-indigo-500), while "Exit" uses the existing subtle text-zinc-400 style.
4. Remove the old standalone Replay badge `<span>` -- it is now rendered by AppHeader.
5. The rest of ReplayShell remains unchanged (three-panel body, hooks, replay controls).

**Key decisions:**
- "Try it live" uses `onBack` per research: TopicPicker already handles API key entry and topic selection. No new modal or flow needed.
- "Try it live" styled with indigo-600 fill to visually distinguish from subtle action buttons (per research pitfall #2).
- Header height is consistent because both modes now use AppHeader with the same tagline.
  </action>
  <verify>`npm run build` completes with no errors. Visually confirm in dev server: both shells show "ThreadTutor" with tagline, topic name, and correct mode badge (emerald "Live" or indigo "Replay"). ReplayShell shows "Try it live" button in filled indigo style.</verify>
  <done>Both ConversationShell and ReplayShell use the shared AppHeader. ConversationShell shows "Live" emerald badge with Export and New topic actions. ReplayShell shows "Replay" indigo badge with "Try it live" CTA (indigo-600 filled) and "Exit" action. Headers are visually consistent between modes.</done>
</task>

</tasks>

<verification>
1. `npm run build` -- no TypeScript or build errors
2. `npm run lint` -- no linting errors
3. Dev server check: Navigate to app without API key -> auto-loads demo replay -> header shows "ThreadTutor" branding, "Socratic learning with AI" tagline, "Bitcoin proof-of-work" topic, "Replay" indigo badge, "Try it live" indigo button, and "Exit" button
4. Dev server check: Click "Try it live" -> returns to TopicPicker form (same as Exit)
5. Dev server check: Enter API key and topic, start conversation -> header shows "ThreadTutor" branding, tagline, topic name, "Live" emerald badge, "Export" and "New topic" buttons
6. Verify header height is the same between replay and live modes (no layout shift when switching)
</verification>

<success_criteria>
- LAND-01: ReplayShell has a visible "Try it live" CTA that exits replay and shows TopicPicker for API key entry
- LAND-04: Mode badge showing "Live" (emerald) in ConversationShell and "Replay" (indigo) in ReplayShell
- LAND-05: Both headers display "ThreadTutor" branding, "Socratic learning with AI" tagline, and current topic name
- No inline header markup remains in ConversationShell or ReplayShell (fully delegated to AppHeader)
- Build and lint pass cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/07-landing-experience/07-01-SUMMARY.md`
</output>
