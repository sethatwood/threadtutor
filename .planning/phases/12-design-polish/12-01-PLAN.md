---
phase: 12-design-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/globals.css
  - app/layout.tsx
  - components/conversation-shell.tsx
  - components/replay-shell.tsx
  - components/message.tsx
  - components/learning-journal.tsx
autonomous: true

must_haves:
  truths:
    - "Selecting text in both dark and light themes shows a visible, theme-appropriate highlight color (not browser default)"
    - "All text across the app renders with subpixel antialiasing (no fuzzy edges on any OS)"
    - "Visual spacing between messages, panels, and sections follows a consistent vertical rhythm with generous whitespace"
    - "Panel borders between conversation, journal, and concept map use subtle theme-aware colors that feel intentional"
  artifacts:
    - path: "app/globals.css"
      provides: "Enhanced selection styling with themed highlight and selection text color, verified antialiased rule"
      contains: "::selection"
    - path: "app/layout.tsx"
      provides: "Verified antialiased class on body element"
      contains: "antialiased"
    - path: "components/conversation-shell.tsx"
      provides: "Refined panel spacing and border styling"
    - path: "components/replay-shell.tsx"
      provides: "Matching panel spacing and border styling"
  key_links:
    - from: "app/globals.css"
      to: "[data-theme] selectors"
      via: "::selection rules per theme"
      pattern: "::selection"
---

<objective>
Apply global design polish: enhance text selection styling with theme-aware highlight colors, verify font smoothing is consistently applied, and refine spacing rhythm and border treatment across shell layouts and content components.

Purpose: Addresses POLISH-01 (spacing), POLISH-02 (borders), POLISH-04 (selection), and POLISH-05 (font smoothing) -- the non-interactive polish requirements that affect global styles and layout components.

Output: Updated globals.css with enhanced selection and smoothing, refined shell components with consistent spacing and softer borders.
</objective>

<execution_context>
@/Users/yayseth/.claude/get-shit-done/workflows/execute-plan.md
@/Users/yayseth/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@app/globals.css
@app/layout.tsx
@components/conversation-shell.tsx
@components/replay-shell.tsx
@components/message.tsx
@components/learning-journal.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance selection styling and verify font smoothing</name>
  <files>app/globals.css, app/layout.tsx</files>
  <action>
In `app/globals.css`:

1. **Selection styling (POLISH-04):** Replace the current minimal `::selection` rules with richer theme-aware selection. For both `[data-theme="dark"]` and `[data-theme="light"]`, set `::selection` with:
   - Dark: `background: rgba(129, 140, 248, 0.3)` (indigo-tinted), `color: #e8e8e8`
   - Light: `background: rgba(79, 70, 229, 0.2)` (indigo-tinted), `color: #1a1a1a`
   This replaces the generic white/black `--color-selection-bg` with brand-aligned indigo highlights.

2. **Remove the now-unused `--color-selection-bg` variable** from both `[data-theme]` blocks since selection styling is defined directly in the `::selection` rules.

3. **Font smoothing (POLISH-05):** Add `-webkit-font-smoothing: antialiased` and `-moz-osx-font-smoothing: grayscale` to the `body` rule in globals.css. The `antialiased` Tailwind class is already on the body element in layout.tsx, but adding the explicit CSS properties ensures coverage regardless of Tailwind class processing order.

In `app/layout.tsx`:
- Verify `antialiased` is present on the body className. It already is (`antialiased` in the template literal), so no change needed. Just confirm during verification.
  </action>
  <verify>
1. Run `npm run build` -- build succeeds with no errors
2. Grep globals.css for `::selection` -- should find rules in both dark and light theme blocks with indigo-tinted backgrounds
3. Grep globals.css for `font-smoothing` -- should find both webkit and moz properties on body
4. Grep layout.tsx for `antialiased` -- should find it on body className
5. Grep globals.css for `--color-selection-bg` -- should NOT find it (removed)
  </verify>
  <done>Text selection in dark theme shows indigo-tinted highlight, light theme shows softer indigo-tinted highlight. Font smoothing is applied via both CSS properties and Tailwind class. The unused --color-selection-bg variable is removed.</done>
</task>

<task type="auto">
  <name>Task 2: Refine spacing rhythm and border treatment across layouts</name>
  <files>components/conversation-shell.tsx, components/replay-shell.tsx, components/message.tsx, components/learning-journal.tsx</files>
  <action>
Audit and refine spacing and borders for consistent rhythm across the app. The goal is generous, intentional whitespace with soft borders.

In `components/message.tsx`:
1. Add `first:pt-0` on the message container div so the first message does not have extra top padding (tighter fit against panel top).
2. Change the border from `border-b border-[var(--color-border)]` to `border-b border-[var(--color-border)]/60` for softer, more subtle message dividers.

In `components/learning-journal.tsx`:
1. Change the header border from `border-b border-[var(--color-border)]` to `border-b border-[var(--color-border)]/60` for softer divider.
2. Increase the journal entry list spacing from `space-y-3` to `space-y-4` for more generous breathing room between entries.

In `components/conversation-shell.tsx`:
1. Change the journal panel border from `md:border-l` (uses browser default 1px solid) to `md:border-l md:border-[var(--color-border)]/50` so the panel divider uses a softer theme-aware color.
2. Change the concept map panel border from `border-t border-[var(--color-border)]` to `border-t border-[var(--color-border)]/50` for softer horizontal dividers between major sections.

In `components/replay-shell.tsx`:
Apply the same border refinements as conversation-shell.tsx:
1. Journal panel: add `md:border-[var(--color-border)]/50` alongside the existing `md:border-l`.
2. Concept map panel: change `border-t border-[var(--color-border)]` to `border-t border-[var(--color-border)]/50`.

**Transition upgrade for shell buttons (coordinated with Plan 02):**
In both `conversation-shell.tsx` and `replay-shell.tsx`, change `transition-colors` to `transition-all duration-150` on the header action buttons (Export, New topic, Try it live, Exit) for consistency with Plan 02's micro-interaction timing.
  </action>
  <verify>
1. Run `npm run build` -- build succeeds with no errors
2. Grep for `border-[var(--color-border)]/50` in conversation-shell.tsx and replay-shell.tsx -- should find the softened panel borders
3. Grep for `border-[var(--color-border)]/60` in message.tsx and learning-journal.tsx -- should find the softened content dividers
4. Grep for `space-y-4` in learning-journal.tsx -- should find increased entry spacing
5. Grep for `first:pt-0` in message.tsx -- should find it on the message container
  </verify>
  <done>Panel dividers use 50% opacity borders (softer than full-strength), content dividers within panels use 60% opacity. Journal entries have more generous spacing. First message in conversation has no extra top padding. Both conversation and replay shells have matching border treatment.</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `npm run build` passes cleanly
2. All modified files exist and contain expected changes
3. Selection styling uses indigo-tinted brand color, not generic white/black
4. Font smoothing properties present in CSS
5. Border opacity is consistently 50% for major panel dividers, 60% for content-level dividers
6. Spacing rhythm is consistent between conversation-shell and replay-shell
</verification>

<success_criteria>
- POLISH-01 (spacing): Visual spacing follows a consistent rhythm with generous whitespace
- POLISH-02 (borders): Panel and content borders use subtle, theme-appropriate opacity
- POLISH-04 (selection): Text selection shows brand-aligned indigo highlight in both themes
- POLISH-05 (font smoothing): Antialiased rendering via CSS properties and Tailwind class
</success_criteria>

<output>
After completion, create `.planning/phases/12-design-polish/12-01-SUMMARY.md`
</output>
