---
phase: 11-component-theme-parity
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - components/confidence-check.tsx
  - components/conversation-panel.tsx
autonomous: true

must_haves:
  truths:
    - "Assessment badges (tracking/partial/confused) are readable with sufficient contrast in both dark and light themes"
    - "Error banner text and dismiss button are readable in both themes"
    - "Confidence check input and submit button have visible focus rings in both themes"
    - "All interactive elements in conversation panel have hover/focus states that work in both themes"
  artifacts:
    - path: "components/confidence-check.tsx"
      provides: "Theme-adaptive assessment badge colors"
      contains: "data-theme"
    - path: "components/conversation-panel.tsx"
      provides: "Theme-adaptive error banner colors"
      contains: "var(--color-"
  key_links:
    - from: "components/confidence-check.tsx"
      to: "app/globals.css"
      via: "CSS custom properties for assessment colors or theme-aware Tailwind classes"
      pattern: "assessmentStyles"
    - from: "components/conversation-panel.tsx"
      to: "app/globals.css"
      via: "CSS custom properties for error banner styling"
      pattern: "rose|error"
---

<objective>
Make the conversation panel's error banner and confidence check assessment badges render with appropriate contrast in both dark and light themes.

Purpose: The assessment badges in confidence-check.tsx use dark-mode-optimized Tailwind colors (text-emerald-300, text-amber-300, text-rose-300) that have poor contrast on light backgrounds. The error banner in conversation-panel.tsx also uses hardcoded rose-300/400/500 colors optimized for dark mode. This plan makes both components theme-aware.

Output: Assessment badges and error banners are readable in both themes with appropriate contrast.
</objective>

<execution_context>
@/Users/yayseth/.claude/get-shit-done/workflows/execute-plan.md
@/Users/yayseth/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-theme-system/10-02-SUMMARY.md

@components/confidence-check.tsx
@components/conversation-panel.tsx
@app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Theme-adaptive assessment badges and error banner</name>
  <files>components/confidence-check.tsx, components/conversation-panel.tsx</files>
  <action>
In confidence-check.tsx:
1. The `assessmentStyles` record currently uses hardcoded dark-optimized colors:
   - tracking: "text-emerald-300 bg-emerald-500/15"
   - partial: "text-amber-300 bg-amber-500/15"
   - confused: "text-rose-300 bg-rose-500/15"
2. These 300-level text colors wash out on light backgrounds. Replace with dual-theme-safe approach.
3. Replace the assessmentStyles object with theme-responsive classes using dark:/light: Tailwind modifiers or a data-attribute approach. The simplest correct approach:
   - tracking: use `text-emerald-700 dark:text-emerald-300 bg-emerald-500/15` (700 has good contrast on light, 300 on dark)
   - partial: use `text-amber-700 dark:text-amber-300 bg-amber-500/15` (same pattern)
   - confused: use `text-rose-700 dark:text-rose-300 bg-rose-500/15` (same pattern)
4. IMPORTANT: Tailwind v4 uses media queries for `dark:` by default. Since this project uses `data-theme` attribute (not class="dark"), we need a different approach. Instead, add CSS custom properties for the three semantic assessment colors to globals.css (see below), then reference them here. OR use the simpler approach of defining the styles inline with Tailwind arbitrary values that reference CSS variables.
5. PREFERRED APPROACH: Add three new CSS variables to globals.css in each [data-theme] block:
   - Dark: `--color-status-success: #6ee7b7;` (emerald-300), `--color-status-warning: #fcd34d;` (amber-300), `--color-status-error: #fda4af;` (rose-300)
   - Light: `--color-status-success: #047857;` (emerald-700), `--color-status-warning: #b45309;` (amber-700), `--color-status-error: #be123c;` (rose-700)
6. Update assessmentStyles to use these CSS variables:
   - tracking: `text-[var(--color-status-success)] bg-[var(--color-status-success)]/15`
   - partial: `text-[var(--color-status-warning)] bg-[var(--color-status-warning)]/15`
   - confused: `text-[var(--color-status-error)] bg-[var(--color-status-error)]/15`
7. NOTE: Tailwind arbitrary value `bg-[var(--color-status-success)]/15` may not work with opacity modifier. If not, use `bg-[color-mix(in_srgb,var(--color-status-success)_15%,transparent)]` instead, or define separate bg variables. The simplest fallback: hardcode both bg colors per theme too:
   - Dark: `--color-status-success-bg: rgba(16, 185, 129, 0.15);`, etc.
   - Light: `--color-status-success-bg: rgba(4, 120, 87, 0.15);`, etc.
   Then use `bg-[var(--color-status-success-bg)]` in the component.

In conversation-panel.tsx:
1. The error banner (lines 148-157) uses hardcoded rose colors:
   - `border-rose-500/30` (border)
   - `bg-rose-500/10` (background)
   - `text-rose-300` (message text)
   - `text-rose-400 hover:text-rose-200` (dismiss button)
2. Add a `--color-status-error` variable (from step 5 above) that already adapts per theme.
3. Replace the error banner colors:
   - border: `border-[var(--color-status-error)]/30`
   - bg: `bg-[var(--color-status-error)]/10`
   - text: `text-[var(--color-status-error)]`
   - dismiss button: `text-[var(--color-status-error)] hover:opacity-70` (simpler than managing hover color per theme)
4. If the Tailwind opacity modifier `/30` and `/10` don't work with CSS variable arbitrary values, use `color-mix()` approach: `border-[color-mix(in_srgb,var(--color-status-error)_30%,transparent)]` and `bg-[color-mix(in_srgb,var(--color-status-error)_10%,transparent)]`.

In globals.css (touched by both components above):
1. Add the status color variables to both [data-theme] blocks, right after the existing palette variables.
  </action>
  <verify>
1. `grep 'emerald-300\|amber-300\|rose-300' components/confidence-check.tsx` returns zero matches (no hardcoded dark-only colors)
2. `grep 'rose-300\|rose-400\|rose-200' components/conversation-panel.tsx` returns zero matches
3. `grep 'color-status-success\|color-status-warning\|color-status-error' app/globals.css` returns matches in both dark and light theme blocks
4. `npm run build` passes
  </verify>
  <done>Assessment badge colors and error banner colors use theme-adaptive CSS custom properties that provide appropriate contrast in both dark and light modes</done>
</task>

</tasks>

<verification>
1. Assessment badges (tracking/partial/confused) use CSS variable colors that resolve differently per theme
2. Error banner uses CSS variable colors that resolve differently per theme
3. All new CSS variables are defined in both [data-theme="dark"] and [data-theme="light"] blocks
4. No hardcoded Tailwind emerald-300/amber-300/rose-300/rose-400 colors remain in component files
5. `npm run build` passes with zero errors
</verification>

<success_criteria>
- Assessment badge text is readable on both dark (#0a0a0a) and light (#f8f6f3) backgrounds
- Error banner text and dismiss button are readable in both themes
- Status CSS variables are defined in both theme palettes
- Build passes
</success_criteria>

<output>
After completion, create `.planning/phases/11-component-theme-parity/11-02-SUMMARY.md`
</output>
